#pragma config(Hubs,  S1, HTMotor,  HTMotor,  HTServo,  HTMotor)
#pragma config(Sensor, S1,     ,                    sensorI2CMuxController)
#pragma config(Motor,  mtr_S1_C1_1,     motor1,        tmotorNormal, openLoop)
#pragma config(Motor,  mtr_S1_C1_2,     motor2,        tmotorNormal, openLoop)
#pragma config(Motor,  mtr_S1_C2_1,     motor3,        tmotorNormal, openLoop)
#pragma config(Motor,  mtr_S1_C2_2,     motor4,        tmotorNormal, openLoop)
#pragma config(Motor,  mtr_S1_C4_1,     flag,          tmotorNormal, openLoop)
#pragma config(Motor,  mtr_S1_C4_2,     motorI,        tmotorNormal, openLoop)
#pragma config(Servo,  srvo_S1_C3_1,    ,                     BadType)
#pragma config(Servo,  srvo_S1_C3_6,    ,                     BadType)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

#include "JoystickDriver.c"

/**
VARS
**/
float speed = 1;
bool pressed_d = false;



void initializeRobot()
{
	waitForStart();
	return;
}

void addSpeed(int add)
{
	speed += add;
}

task main()
{
	initializeRobot();
	while (true) {
		getJoystickSettings(joystick);
	  int yval = joystick.joy1_y1;
		int xval = joystick.joy1_x1;

		motor[motor1] = (-yval - xval) / speed;
		motor[motor4] = (-yval - xval) / speed;

		motor[motor2] = (yval - xval) / speed;
		motor[motor3] = (yval - xval) / speed;

		if (!pressed_d) {
	  		if (joystick.joy1_TopHat == 0 || joystick.joy1_TopHat == 4) {
				pressed_d = true;
				if (joystick.joy1_TopHat == 0)
					addSpeed(0.5);
				else
					addSpeed(-0.5)
			}
		} else if (pressed_d && joystick.joy1_TopHat == -1) {
			pressed_d = false;
		}

		if(joy1Btn(6)==1) // if button 6 is pressed
		{
			servo[servo1]=255; // bulldozer lifts up
			servo[servo6]=255;
		}
		else									// if not pressed bulldozer is down
		{
			servo[servo1]=30;
			servo[servo6]=30;
		}
		if(joy1Btn(1)==1) // if button 1 is pressed
		{
		  motor[flag]=100; // flag raiser motor will activate
		}
		else if (joy1Btn(3))									// if not pressed
		{
			motor[flag]=-100;   // flag motor will not activate
		} else {
		  motor[flag]=0;
		}
	}
}
